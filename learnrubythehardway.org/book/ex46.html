<!DOCTYPE html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="twitter:creator" content="@lzsthw">
        <title>Learn Ruby</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href='stylesheets/pure.css' rel='stylesheet'>
        <link href='stylesheets/pygments.css' rel='stylesheet'>
        <link href='stylesheets/main.css' rel='stylesheet'>
        <link href='stylesheets/nav.css' rel='stylesheet'>
        <link href='http://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,900,700italic,900italic' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Dosis:200,300,400,500,600,700,800' rel='stylesheet' type='text/css'>
        <style>
        </style>
 
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.11: http://docutils.sourceforge.net/" />
<title>Exercise 46: A Project Skeleton</title>
    </head>
    <body id='wrapper'>
        <div class='master-logo-wrapper ruby-edition clearfix'>
            <a href='index.html'>
                <div class='ruby-logo-sprite'></div>
            </a>
                <span class='edition-3 ruby-edition'><img src='images/3rd-edition-cloud.png' /></span>
        </div><!-- /.master-logo-wrapper -->

        <div style='clear: both;'>

        <div id="main">
            <div class='chapters-wrapper'>
                  <nav id='chapters'>
                      <div class='masthead-title'></div>
                      <ul class='masthead'>
                          <li>
                              <a href='index.html'>
                                  <div class='nav-tcontents'>
                                      <img src='images/nav-contents.png' /></br>
                                  main
                                  </div>
                              </a>
                          </li>
                          <li>
                              <a href='ex46.html#video'>
                                  <div class='nav-play-video' id="#video_toggle_icon">
                                      <img src='images/nav-play.png' /><br/>
                                      play video
                                      <div class='line-2'>(this chapter)</div>
                                  </div>
                              </a>
                          </li>
                          <li>
                              <a href='ex46.html' id='prev_link'>
                                  <div class='nav-previous'>
                                      <img src='images/nav-previous.png' /></br>
                                      previous
                                  </div>
                              </a>
                          </li>
                          <li>
                              <a href='ex46.html' id='next_link'>
                                  <div class='nav-next'>
                                      <img src='images/nav-next.png' /></br>
                                      next
                                  </div>
                              </a>
                          </li>
                          <li><!-- AMBULANCE ICON -->
                              <a href='help.html' id=''>
                                  <div class='ambulance'>
                                      <img src='images/help-ambulance.png' /></br>
                                      help
                                  </div>
                              </a>
                          </li>
                          <li id="follow">
                                <a href="https://twitter.com/lzsthw" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false" data-dnt="true">Follow @lzsthw</a>
                                <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                           </li>

                      </ul><!-- /.masthead -->
                      <!--<img src='images/fa-bullhorn.png' />-->
                  </nav><!-- /.chapters -->
            </div><!-- /.chapters-wrapper -->

        <!--- RST STARTS -->
            <h1 class="title">Exercise 46: A Project Skeleton</h1>
            <p>This will be where you start learning how to set up a good project &quot;skeleton&quot; directory.  This skeleton directory will have all the basics you need to get a new project up and running.  It will have your project layout, automated tests, modules, and install scripts.  When you go to make a new project, just copy this directory to a new name and edit the files to get started.</p>
<div class="section" id="creating-the-skeleton-project-directory">
<h1>Creating the Skeleton Project Directory</h1>
<p>First, create the structure of your skeleton directory with these commands:</p>
<pre class="code console literal-block">
<span class="generic prompt">$</span> mkdir projects
<span class="generic prompt">$</span> <span class="name builtin">cd </span>projects
<span class="generic prompt">$</span> mkdir skeleton
<span class="generic prompt">$</span> <span class="name builtin">cd </span>skeleton
<span class="generic prompt">$</span> mkdir bin data doc ext lib tests lib/NAME
</pre>
<p>I use a directory named <tt class="docutils literal">projects</tt> to store all the various things I'm working on.  Inside that directory I have my <tt class="docutils literal">skeleton</tt> directory that I put the basis of my projects into.</p>
<p>Next we need to set up some initial files.  Here's how you do that on Linux/OSX:</p>
<pre class="code console literal-block">
<span class="generic prompt">$</span> touch bin/NAME
<span class="generic prompt">$</span> touch lib/NAME.rb
</pre>
<p>Here's the same thing on Windows PowerShell:</p>
<pre class="code console literal-block">
<span class="generic prompt">$</span> new-item -type file  bin/NAME
<span class="generic prompt">$</span> new-item -type file  lib/NAME.rb
</pre>
<p>That creates an empty Ruby module directories we can put our code in.  Then we need to create a sample <tt class="docutils literal">gemspec</tt> file name <tt class="docutils literal">NAME.gemspec</tt> that will describe our project:</p>
<div class="highlight"><pre><a name="ruby--skeleton--NAME.gemspec-idio.html-1"></a><span class="c1"># coding: utf-8</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-2"></a><span class="n">lib</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s1">&#39;../lib&#39;</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-3"></a><span class="vg">$LOAD_PATH</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="n">lib</span><span class="p">)</span> <span class="k">unless</span> <span class="vg">$LOAD_PATH</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">lib</span><span class="p">)</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-4"></a>
<a name="ruby--skeleton--NAME.gemspec-idio.html-5"></a><span class="ss">Gem</span><span class="p">:</span><span class="ss">:Specification</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">spec</span><span class="o">|</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-6"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">name</span>          <span class="o">=</span> <span class="s2">&quot;NAME&quot;</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-7"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">version</span>       <span class="o">=</span> <span class="s1">&#39;1.0&#39;</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-8"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">authors</span>       <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;Your Name Here&quot;</span><span class="o">]</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-9"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">email</span>         <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;youremail@yourdomain.com&quot;</span><span class="o">]</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-10"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">summary</span>       <span class="o">=</span> <span class="sx">%q{Short summary of your project}</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-11"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">description</span>   <span class="o">=</span> <span class="sx">%q{Longer description of your project.}</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-12"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">homepage</span>      <span class="o">=</span> <span class="s2">&quot;http://domainforproject.com/&quot;</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-13"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">license</span>       <span class="o">=</span> <span class="s2">&quot;MIT&quot;</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-14"></a>
<a name="ruby--skeleton--NAME.gemspec-idio.html-15"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">files</span>         <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;lib/NAME.rb&#39;</span><span class="o">]</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-16"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">executables</span>   <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;bin/NAME&#39;</span><span class="o">]</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-17"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">test_files</span>    <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;tests/test_NAME.rb&#39;</span><span class="o">]</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-18"></a>  <span class="n">spec</span><span class="o">.</span><span class="n">require_paths</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;lib&quot;</span><span class="o">]</span>
<a name="ruby--skeleton--NAME.gemspec-idio.html-19"></a><span class="k">end</span>
</pre></div><p>Edit this file so that it has your contat information and is ready to go for when you copy it.</p>
<p>Next you want to create a <tt class="docutils literal">Rakefile</tt> file that will help you automate common tasks when working with Ruby.  Write this code for you Rakefile to make it run your tests for you:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><a name="ruby--skeleton--Rakefile-idio.html-1"></a>require &#39;rake/testtask&#39;
<a name="ruby--skeleton--Rakefile-idio.html-2"></a>
<a name="ruby--skeleton--Rakefile-idio.html-3"></a>Rake::TestTask.new do |t|
<a name="ruby--skeleton--Rakefile-idio.html-4"></a>  t.libs &lt;&lt; &quot;tests&quot;
<a name="ruby--skeleton--Rakefile-idio.html-5"></a>  t.test_files = FileList[&#39;tests/test*.rb&#39;]
<a name="ruby--skeleton--Rakefile-idio.html-6"></a>  t.verbose = true
<a name="ruby--skeleton--Rakefile-idio.html-7"></a>end
</pre></div>
</td></tr></table><p>Finally you will want a simple skeleton file for tests named <tt class="docutils literal">tests/test_NAME.rb</tt>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><a name="ruby--skeleton--tests--test_NAME.rb-idio.html-1"></a><span class="nb">require</span> <span class="s2">&quot;./lib/NAME.rb&quot;</span>
<a name="ruby--skeleton--tests--test_NAME.rb-idio.html-2"></a><span class="nb">require</span> <span class="s2">&quot;test/unit&quot;</span>
<a name="ruby--skeleton--tests--test_NAME.rb-idio.html-3"></a>
<a name="ruby--skeleton--tests--test_NAME.rb-idio.html-4"></a><span class="k">class</span> <span class="nc">TestNAME</span> <span class="o">&lt;</span> <span class="ss">Test</span><span class="p">:</span><span class="ss">:Unit</span><span class="o">::</span><span class="no">TestCase</span>
<a name="ruby--skeleton--tests--test_NAME.rb-idio.html-5"></a>
<a name="ruby--skeleton--tests--test_NAME.rb-idio.html-6"></a>  <span class="k">def</span> <span class="nf">test_sample</span>
<a name="ruby--skeleton--tests--test_NAME.rb-idio.html-7"></a>    <span class="n">assert_equal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<a name="ruby--skeleton--tests--test_NAME.rb-idio.html-8"></a>  <span class="k">end</span>
<a name="ruby--skeleton--tests--test_NAME.rb-idio.html-9"></a>
<a name="ruby--skeleton--tests--test_NAME.rb-idio.html-10"></a><span class="k">end</span>
</pre></div>
</td></tr></table><div class="section" id="final-directory-structure">
<h2>Final Directory Structure</h2>
<p>When you are done setting all this up, your directory should look like mine here:</p>
<pre class="code console literal-block">
<span class="generic output">skeleton/
    NAME.gemspec
    Rakefile
    data
    ext/
    tests/
    bin/
        NAME
    doc/
    lib/
        NAME
        NAME.rb
    lib/NAME
    tests/
        test_NAME.rb</span>
</pre>
<p>From now on, you should run your commands from that work with this directory from this point.  If you can't do <tt class="docutils literal">ls <span class="pre">-R</span></tt> and see this same structure, then you are in the wrong place.  For example, people commonly go into the <tt class="docutils literal">tests/</tt> directory to try to run files there, which won't work.  To run your application's tests, you would need to be <em>above</em> <tt class="docutils literal">tests/</tt> and this location I have above.  So, if you try this:</p>
<pre class="code console literal-block">
<span class="generic prompt">$</span> <span class="name builtin">cd </span>tests/   <span class="comment"># WRONG! WRONG! WRONG!
</span><span class="generic prompt">$</span><span class="comment"></span> rake <span class="name builtin">test</span>
</pre>
<p>Then that is <em>wrong</em>! You have to be <em>above</em> tests, in the <tt class="docutils literal">skeleton/</tt> directory itself, not in directories below <tt class="docutils literal">skeleton/</tt>.  If you made this mistake just do this:</p>
<pre class="code console literal-block">
<span class="generic prompt">$</span> <span class="name builtin">cd</span> ..  <span class="comment"># get out of tests/
</span><span class="generic prompt">$</span><span class="comment"></span> ls     <span class="comment"># CORRECT!~ you are now in the right spot
</span><span class="generic output">NAME.gemspec        data            ext             tests
bin         doc             lib
</span><span class="generic prompt">$</span> rake <span class="name builtin">test</span>
<span class="generic output">Loaded suite tests/test_NAME
Started
.
Finished in 0.000226 seconds.

1 tests, 1 assertions, 0 failures, 0 errors</span>
</pre>
</div>
</div>
<div class="section" id="testing-your-setup">
<h1>Testing Your Setup</h1>
<p>After you get all this installed you should be able to do this:</p>
<pre class="code console literal-block">
<span class="generic prompt">$</span> rake <span class="name builtin">test
</span><span class="generic prompt">#</span><span class="name builtin"> </span>A bunch of load junk here, ignore it.
<span class="generic output">Loaded suite tests/test_NAME
Started
.
Finished in 0.000226 seconds.

1 tests, 1 assertions, 0 failures, 0 errors</span>
</pre>
<p>I'll explain Ruby's <tt class="docutils literal"><span class="pre">Test::Unit</span></tt> in the next exercise, but for now if you don't see that or get syntax errors then you made a mistake in one of the files or you are in the wrong place:</p>
</div>
<div class="section" id="using-the-skeleton">
<h1>Using the Skeleton</h1>
<p>You are now done with most of your yak shaving.  Whenever you want to start a new project, just do this:</p>
<ol class="arabic simple">
<li>Make a copy of your skeleton directory.  Name it after your new project.</li>
<li>Rename (move) the <tt class="docutils literal">lib/NAME.rb</tt> file and <tt class="docutils literal">lib/NAME/</tt> directory to be the name of your project or whatever you want to call your root module.</li>
<li>Edit your <tt class="docutils literal">Gemspec</tt> to have all the information for your project.</li>
<li>Rename <tt class="docutils literal">tests/test_NAME.rb</tt> to also have your module name.</li>
<li>Double check it's all working by using <tt class="docutils literal">ruby tests/test_yourproject.rb</tt> again.</li>
<li>Start coding.</li>
</ol>
</div>
<div class="section" id="required-quiz">
<h1>Required Quiz</h1>
<p>This exercise doesn't have Study Drills but a quiz you should complete:</p>
<ol class="arabic simple">
<li>Read about how to use all of the things you installed.</li>
<li>Read about the <tt class="docutils literal">NAME.gemspec</tt> file, commonly called a &quot;Gemspec&quot;, and all it has to offer.</li>
<li>Make a project put code into the module, then get the module working. This means you have to change all the files, directories, and modules with <tt class="docutils literal">NAME</tt> in them to the name of your project.  If you get stuck, watch the video for this exercise to see how I did it.</li>
<li>Put a script in the <tt class="docutils literal">bin</tt> directory that you can run.  Read about how you can make a Ruby script that's runnable for your system.</li>
<li>Mention the <tt class="docutils literal">bin</tt> script you created in your <tt class="docutils literal">Gemspec</tt> so that it gets installed.</li>
<li>Use your <tt class="docutils literal">Gemspec</tt> to install your own module and make sure it works, then use
<tt class="docutils literal">gem</tt> to uninstall it.</li>
</ol>
</div>
<div class="section" id="common-student-questions">
<h1>Common Student Questions</h1>
<dl class="docutils">
<dt>Do these instructions work on Windows?</dt>
<dd>They should, but depending on the version of Windows you may need to struggle with the setup a bit to get it working.  Just keep researching and trying it until you get it, or see if you can ask a more experienced Ruby+Windows friend to help out.</dd>
<dt>Why do we need a <tt class="docutils literal">bin/</tt> folder?</dt>
<dd>This is just a standard place to put scripts that are run on the command line, not a place to put modules.</dd>
<dt>Do you have a real world example project?</dt>
<dd>There are many projects written in Ruby that do this, but try this simple one I created <a class="reference external" href="https://rubygems.org/gems/mongrel">https://rubygems.org/gems/mongrel</a> with source at <a class="reference external" href="https://github.com/mongrel/mongrel">https://github.com/mongrel/mongrel</a> for you to browse.</dd>
<dt>My <tt class="docutils literal">ruby tests/test_NAME.rb</tt> run shows one test being run. Is that right?</dt>
<dd>Yes, that's what my output shows too.</dd>
</dl>
</div>
        <!-- RST ENDS -->

            <!-- /.help-icon -->
        <div id="video_holder" style="display:hidden">
            <h1>Video</h1>
            <div id="video" class="row inner">
                <div class="small-12 small-centered columns">
                    <div data-paydiv_product="5" id='paydiv'>
                        &nbsp;
                    </div>
                </div>
            </div>
        </div>

        </div><!-- /#main -->

        <div class='ad-deck gold' id="footer">
            <ul class='retailers clearfix'>
                <li class=''>
                    <a href='https://paydiv.io/access/buy/5/'>
                        <div class='retailer-name'>Zed Shaw</div>
                        <div class='book-type'>PDF + Videos + Updates</div>
                        <div class='book-price'>$26.67</div>
                    </a>
                </li>
                <li class=''>
                    <a href="http://www.amazon.com/gp/product/032188499X/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=032188499X&linkCode=as2&tag=lepythhawa-20&linkId=IDFZUUSBQWJ7ETF7">
                        <div class='retailer-name'>Amazon</div>
                        <div class='book-type'>Paper + DVD</div>
                        <div class='book-price'>$26.67</div>
                    </a>
                </li>
                <li class=''>
                    <a href='https://paydiv.io/access/buy/5/'>
                        <div class='retailer-name'>Zed Shaw</div>
                        <div class='book-type'>PDF + Videos + Updates</div>
                        <div class='book-price'>$26.67</div>
                    </a>
                </li>
                <li class=''>
                    <a href="http://www.amazon.com/gp/product/032188499X/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=032188499X&linkCode=as2&tag=lepythhawa-20&linkId=IDFZUUSBQWJ7ETF7">
                        <div class='retailer-name'>Amazon</div>
                        <div class='book-type'>Paper + DVD</div>
                        <div class='book-price'>$26.67</div>
                    </a>
                </li>
                <li class=''>
                    <a href="http://learnpythonthehardway.org/book/">
                        <div class='retailer-name'>Interested In Python?</div>
                        <div class='book-type'>Python is also a great language.</div>
                        <div class='book-price'>Learn Python The Hard Way</div>
                    </a>
                </li>
            </ul><!-- /.places -->
        </div><!-- /#ad-deck -->

        <script src="javascripts/jquery.js"></script>
        <script src="index.js"></script>
        <script src="https://paydiv.io/static/jzed.js"></script>
        <script src="https://paydiv.io/static/js/videojs/video.js"></script>
        <link rel="stylesheet" href="https://paydiv.io/static/js/videojs/video-js.css">
        <script src="https://paydiv.io/static/api/v1/paydiv.js"></script>
        <script src="javascripts/app.js"></script>
        <script src="javascripts/littools.js"></script>
        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-24168052-9']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
        </body>
</html>

